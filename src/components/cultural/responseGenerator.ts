
import { MessageProps } from './ChatMessage';

// الأسئلة المقترحة بناءً على السياق الثقافي
export const suggestedQuestions = [
  {
    text: "ما هي الأطعمة المناسبة خلال فترة الحمل حسب التقاليد الإسلامية؟",
    category: "nutrition",
  },
  {
    text: "كيف أحافظ على صلاتي خلال الحمل إذا كان الوقوف صعباً علي؟",
    category: "worship",
  },
  {
    text: "هل يمكنني استخدام الأدوية المسكنة أثناء الحمل وما هو البديل الطبيعي؟",
    category: "medical",
  },
  {
    text: "ما هي الأدعية المأثورة للحامل والجنين؟",
    category: "worship",
  },
  {
    text: "كيف يؤثر الصيام في رمضان على الحمل؟",
    category: "worship",
  },
  {
    text: "ما هي علامات خطر الحمل التي يجب أن أنتبه لها؟",
    category: "medical",
  },
];

// محاكاة توليد الاستجابة
export const generateResponse = (question: string): MessageProps => {
  // محاكاة معالجة الذكاء الاصطناعي
  let hasQuran = question.includes("دعاء") || question.includes("أدعية") || question.includes("قرآن");
  let hasHadith = question.includes("حديث") || question.includes("السنة") || question.includes("النبي");
  let isMedical = question.includes("صحة") || 
                  question.includes("طبي") || 
                  question.includes("مرض") ||
                  question.includes("ألم") ||
                  question.includes("دواء");
  
  let response = "";
  let sources: string[] = [];
  
  if (question.includes("الأطعمة") || question.includes("التغذية") || question.includes("غذاء")) {
    response = "من الناحية الطبية، ينصح الأطباء بتناول الأطعمة الغنية بالفولات مثل الخضروات الورقية الداكنة والحمضيات والبقوليات. وفي التراث الإسلامي، ورد في السنة النبوية فضل بعض الأطعمة مثل التمر والعسل والحبة السوداء. وقد أشارت دراسات حديثة إلى فوائد التمر للحامل خاصة في الأسابيع الأخيرة من الحمل.";
    sources = ["صحيح البخاري: كتاب الأطعمة", "دراسة جامعة الملك سعود 2019: فوائد التمر للحامل"];
  } else if (question.includes("صلاة") || question.includes("صلاتي")) {
    response = "يمكنك أداء الصلاة جالسة إذا كان الوقوف يسبب لك مشقة أو تعباً شديداً. ذكر الفقهاء أن المشقة تجلب التيسير، والله تعالى يقول: (لا يكلف الله نفساً إلا وسعها). ويمكنك الجمع بين الصلوات عند الحاجة بحسب رأي بعض المذاهب الفقهية.";
    sources = ["سورة البقرة: 286", "فتاوى اللجنة الدائمة للإفتاء: 6/244"];
    hasQuran = true;
  } else if (question.includes("مسكنة") || question.includes("أدوية")) {
    response = "من الناحية الطبية، هناك بعض المسكنات الآمنة أثناء الحمل مثل الباراسيتامول (تحت إشراف الطبيب)، ولكن يجب تجنب مضادات الالتهاب غير الستيرويدية مثل الإيبوبروفين. أما البدائل الطبيعية فتشمل الراحة، والكمادات الدافئة، وتدليك المناطق المؤلمة برفق. ورد في الطب النبوي استخدام الحبة السوداء والعسل لتخفيف بعض الآلام.";
    sources = ["منظمة الصحة العالمية: إرشادات استخدام الأدوية أثناء الحمل", "صحيح مسلم: باب التداوي بالحبة السوداء"];
    isMedical = true;
    hasHadith = true;
  } else if (question.includes("أدعية") || question.includes("دعاء")) {
    response = "من الأدعية المأثورة للحامل: \"اللهم إني أستودعك ما في رحمي، اللهم اجعله خلقاً سوياً، واجعله ذخراً لوالديه\". ويمكن للحامل أن تكثر من الدعاء بما ورد في القرآن على لسان أم مريم: \"رَبِّ إِنِّي نَذَرْتُ لَكَ مَا فِي بَطْنِي مُحَرَّرًا فَتَقَبَّلْ مِنِّي إِنَّكَ أَنْتَ السَّمِيعُ الْعَلِيمُ\".";
    sources = ["سورة آل عمران: 35", "موسوعة الأدعية والأذكار: صفحة 120"];
    hasQuran = true;
  } else if (question.includes("رمضان") || question.includes("صيام")) {
    response = "يجوز للحامل الإفطار في رمضان إذا كان الصيام يضر بها أو بجنينها، وذلك لقوله تعالى: (وَعَلَى الَّذِينَ يُطِيقُونَهُ فِدْيَةٌ طَعَامُ مِسْكِينٍ). واختلف العلماء في وجوب القضاء عليها، فذهب جمهور العلماء إلى وجوب القضاء، بينما يرى ابن عباس رضي الله عنهما أنها تطعم عن كل يوم مسكيناً ولا قضاء عليها.";
    sources = ["سورة البقرة: 184", "تفسير القرطبي: 2/278", "صحيح البخاري: كتاب الصوم"];
    hasQuran = true;
    hasHadith = true;
  } else if (question.includes("علامات خطر") || question.includes("مخاطر")) {
    response = "من علامات الخطر التي تستدعي مراجعة الطبيب فوراً: النزيف المهبلي، آلام شديدة في البطن، صداع شديد مع تغيرات في الرؤية، تورم مفاجئ في اليدين أو الوجه، قلة حركة الجنين. وقد حث النبي صلى الله عليه وسلم على المبادرة بالتداوي بقوله: \"تداووا عباد الله، فإن الله لم يضع داء إلا وضع له شفاء\".";
    sources = ["منظمة الصحة العالمية: دليل رعاية الحوامل", "سنن الترمذي: باب ما جاء في الدواء والحث عليه"];
    isMedical = true;
    hasHadith = true;
  } else {
    // استجابة افتراضية
    response = "شكراً على سؤالك. من منظور يجمع بين الطب الحديث والثقافة الإسلامية، يمكنني مساعدتك في مسائل الحمل والأمومة مع احترام الخصوصية الثقافية والدينية. هل لديك سؤال محدد في جانب معين من جوانب الحمل أو رعاية الأطفال؟";
  }
  
  return {
    id: Math.random().toString(36).substring(2, 9),
    content: response,
    role: 'assistant',
    timestamp: new Date(),
    sources,
    hasQuran,
    hasHadith,
    isMedical
  };
};
